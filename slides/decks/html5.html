<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=Edge;chrome=1"/>
  <link rel='stylesheet' href='/slides/static/slides.css'/>
  <title>Creating High Performance Graphical Web Apps with HTML5</title>

  <!-- syntax highlighting stuff -->
	<script type="text/javascript" src="syntax/scripts/shCore.js"></script>
	<script type="text/javascript" src="syntax/scripts/shBrushJScript.js"></script>
	<script type="text/javascript" src="syntax/scripts/shBrushJava.js"></script>
	<script type="text/javascript" src="syntax/scripts/shBrushXml.js"></script>
	<script type="text/javascript" src="syntax/scripts/shBrushCss.js"></script>
	<link type="text/css" rel="stylesheet" href="syntax/styles/shCoreEclipse.css"/>
	<script type="text/javascript">
  SyntaxHighlighter.defaults['gutter'] = false;
  SyntaxHighlighter.all();
  </script>

  <style>
  .intro    { margin-top:5em; }
  .intro h1 { font-size: 96px; }
  .intro h2 { font-size: 40px; }

  header {
    font-size: 32pt;
    width: 90%;
  }

  section, footer {
    margin: 120px 30px 0;
  }

  hr {
    margin: 0.2em;
  }

  img.tl { position: absolute;    top: 0;  left: 0; }
  img.tr { position: absolute;    top: 0; right: 0; }
  img.bl { position: absolute; bottom: 0; right: 0; }
  img.br { position: absolute; bottom: 0;  left: 0; }

  .demo {
    position: absolute;
    left: 10px; top: 10px;
    right: 10px; bottom: 10px;
  }
  .demo iframe {
    border: 0px;
  }

  table.browserSupport {
    border: 2px solid #ccc;
    width: 100%; height: 20em;
    border-collapse: collapse;
  }

  table.browserSupport th { background-color: #ccc; }

  table.browserSupport th,
  table.browserSupport td {
    border: 2px solid #444;
    text-align: center;
  }

  table.tech {
    border: 2px solid #ccc;
    width: 100%;
    border-collapse: collapse;
  }

  table.tech tr {
    height: 3em;
  }

  table.tech th,
  table.tech td {
    border: 2px solid #444;
    text-align: center;
  }

  .pic {
    position: absolute;
    opacity:0;
    -webkit-box-shadow: 5px 5px 5px #444;
    -webkit-transition-property: -webkit-transform, opacity;
    -webkit-transition-duration: 1s;
    -webkit-transition-timing-function: ease-in-out;
  }

  svg text {
    font-family: HelveticaNeueLT;
    font-size: 24px;
  }

  svg text.code {
    font-family: Inconsolata;
    font-size: 24px;
  }

  svg line { stroke:rgb(0, 0, 0); stroke-width:2 }
  svg polygon { fill:rgb(0, 0, 0); stroke-width:0 }
  </style>

  <script>
  // Picture animation helpers.
  function stylePic(pic, x, y, r, scale, opacity) {
      pic.style['-webkit-transform'] =
        'translate3d(' + x + 'px,' + y + 'px,0px) ' +
        'rotate(' + r + 'deg) ' +
        'scale(' + scale + ')';
      pic.style.opacity = opacity;
  }

  function initPics(slide, positions, rot) {
    var i = 0;
    var imgs = query('img.pic', slide).forEach(function(img) {
      var p = positions[i++];
      var y = (p.y - 200) * 8 + 200;
      stylePic(img, p.x, y, p.r + rot, 4, 0);
    });
  }

  function animatePics(slide, positions) {
    var i = 0;
    var imgs = query('img.pic', slide).forEach(function(img) {
      var p = positions[i++];
      stylePic(img, p.x, p.y, p.r, 1, 1);
    });
  }
  </script>
</head>

<body>
  <div class="presentation">
    <div class="slides">

      <div class="slide segue blue">
        <section class="intro">
          <h2>Creating High Performance Graphical Web Apps with HTML5</h2>
          <hr> <br>
          <div>Henry Bridge</div>
          <div>Joel Webber</div>
          <div>Ray Cromwell</div>
          <br>
          <div>20 Oct, 2010</div>
        </section>
      </div>

      <div class="slide" oninit='initPics(this, _positions2, 0)' onload='animatePics(this, _positions2)' onunload='initPics(this, _positions2, 0)'>
        <script>
        var _positions2 = [
          { x:  0, y:  0, r:-20 },
          { x:500, y:  0, r: 20 },
          { x:  0, y:370, r: 20 },
          { x:450, y:300, r:-20 },
        ];
        </script>
        <header> <h1>What can you do with web graphics today?</h1> <hr> </header>
        <section style='height:550px;'>
          <img class='pic' src='html5/gallery.png' class='tr'>
          <img class='pic' src='html5/aquarium.png' class='tl'>
          <img class='pic' src='html5/collectibles.png' class='bl'>
          <img class='pic' src='html5/darkroom.png' class='br'>
        </section>
      </div>

      <div class="slide">
        <div class='demo'>
          <iframe width='100%' height='100%' scrolling='no' _src='http://webglsamples.googlecode.com/hg/aquarium/aquarium.html'></iframe>
        </div>
      </div>

      <div class="slide">
        <div class='demo'>
          <iframe width='100%' height='100%' scrolling='no' _src='http://webglsamples.googlecode.com/hg/collectibles/index.html'></iframe>
        </div>
      </div>

      <div class="slide">
        <div class='demo' style='background-color:black;'>
          <iframe width='100%' height='100%' scrolling='no' _src='http://developer.apple.com/safaridemos/showcase/gallery/'></iframe>
        </div>
      </div>

      <div class="slide">
        <div class='demo'>
          <iframe width='100%' height='100%' scrolling='no' _src='http://mugtug.com/darkroom/'></iframe>
        </div>
      </div>

      <div class="slide">
        <header> <h1>Why the web</h1> <hr> </header>
        <section>
          <ul>
            <li>No install</li>
            <li>Seamless update</li>
            <li>Cross-platform device support</li>
          </ul>
        </section>
      </div>

      <div class="slide">
        <header> <h1>We've come a long way</h1> <hr> </header>
        <section>
          <svg width='100%' height='100%'>
            <line x1='10' y1='300' x2='800' y2='300'/>
            <polygon points='800,300 790,305 790,295'/>

            <text  x='50'  y='230' text-anchor='middle' class='code'>&lt;img&gt;</text>
            <line x1='50' y1='250' x2='50' y2='350'/>
            <text  x='50'  y='380' text-anchor='middle'>1993</text>

            <image x='225'  y='25' width='150px' height='150px' xlink:href='html5/butterfly.png'/>
            <text  x='300'  y='200' text-anchor='middle'>SVG</text>
            <text  x='300'  y='230' text-anchor='middle' class='code'>&lt;canvas&gt;</text>
            <line x1='300' y1='250' x2='300' y2='350'/>
            <text  x='300'  y='380' text-anchor='middle'>2005</text>

            <image x='425'  y='25' width='150px' height='150px' xlink:href='html5/css3.png'/>
            <line x1='500' y1='250' x2='500' y2='350'/>
            <text  x='500'  y='230' text-anchor='middle'>CSS 3</text>
            <text  x='500'  y='380' text-anchor='middle'>2007</text>

            <image x='625'  y='25' width='150px' height='150px' xlink:href='html5/webgl.png'/>
            <line x1='700' y1='250' x2='700' y2='350'/>
            <text  x='700'  y='230' text-anchor='middle'>WebGL</text>
            <text  x='700'  y='380' text-anchor='middle'>2009</text>
          </svg>
        </section>
      </div>

      <div class="slide">
        <header> <h1>Browser and device support</h1> <hr> </header>
        <section>
          <table class='browserSupport'>
            <colgroup> <col width='10%'> <col width='10%'> <col width='10%'> <col width='10%'> <col width='10%'> <col width='10%'> <col width='10%'> </colgroup>
            <tr height='3em'> <th></th>       <th>IE 9</th>     <th>Firefox</th>  <th>Chrome</th>   <th>Safari</th>   <th>Mobile Safari</th> <th>Android Browser</th> </tr>
            <tr>              <th>SVG</th>    <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td>      <td>&#x221A;</td>        </tr>
            <tr>              <th>Canvas</th> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td>      <td>&#x221A;</td>        </tr>
            <tr>              <th>3D CSS</th> <td>        </td> <td>        </td> <td>&#x221A;</td> <td>&#x221A;</td> <td>&#x221A;</td>      <td>        </td>        </tr>
            <tr>              <th>WebGL</th>  <td>        </td> <td>&#x221A;</td> <td>&#x221A;</td> <td>        </td> <td>        </td>      <td>        </td>        </tr>
          </table>
        </section>
      </div>

      <div class="slide" oninit='initPics(this, _positions0, 45)' onload='animatePics(this, _positions0)' onunload='initPics(this, _positions0, 45)'>
        <script>
        var _positions0 = [
          { x:500, y:350, r:0 },
          { x:-50, y:300, r:-10 },
          { x:300, y:50, r:-15 },
          { x:250, y:300, r:-30 },
          { x:550, y:0, r:25 },
          { x:0, y:0, r:15 },
        ];
        </script>
        <header> <h1>SVG & &lt;canvas&gt; &mdash; dynamic 2D</h1> <hr> </header>
        <section style='height:23em'>
          <img class='pic' style='width:400px; height:200px;' src='html5/keyboard.png'>
          <img class='pic' style='width:400px; height:300px;' src='html5/mailgame.png'>
          <img class='pic' style='width:400px; height:300px;' src='html5/spacegame.png'>
          <img class='pic' style='width:300px; height:200px;' src='html5/sketch.png'>
          <img class='pic' style='width:400px; height:300px;' src='html5/wilderness.png'>
          <img class='pic' style='width:400px; height:250px;' src='html5/mugtug.png'>
        </section>
      </div>

      <div class="slide">
        <header> <h1>SVG for interactive UI</h1> <hr> </header>
        <section>
          <img width='95%' src='html5/svg.png' style='margin-top: 1.5em;'>
        </section>
      </div>

      <div class="slide">
        <header> <h1>Creating SVG content is easy</h1> <hr> </header>
        <section>
          <img style='float:left; width:55%;' src='html5/svg_static.png'>
          <div style='float:left; width:40%; padding-left:0.5em;'>
            <pre class='brush:xml'>
              &lt;rect style="fill:#000080;
                fill-rule:evenodd;
                stroke:#000000;
                stroke-width:1px;
                stroke-linecap:butt;
                stroke-linejoin:miter;
                stroke-opacity:1"
                id="rect3001"
                width="377.14285"
                height="365.71429"
                x="54.285713"
                y="232.36218"/&gt;
              &lt;rect style="fill:#ff0000"
                id="rect3003"
                width="362.85715"
                height="377.14285"
                x="237.14285"
                y="452.36218"/&gt;
            </pre>
          <div>
        </section>
      </div>

      <div class="slide">
        <header> <h1>Making SVG content dynamic is also easy</h1> <hr> </header>
        <section>
          <svg style='float:left' width='45%' height='20em'>
            <style type="text/css">
              circle:hover { fill-opacity:0.9; }
            </style>
            <g style='fill-opacity:0.7;'>
              <circle cx='5cm' cy='2cm' r='100' style='fill:red; stroke:black; stroke-width:0.1cm' transform='translate(0,50)' />
              <circle cx='5cm' cy='2cm' r='100' style='fill:blue; stroke:black; stroke-width:0.1cm' transform='translate(70,150)' />
              <circle cx='5cm' cy='2cm' r='100' style='fill:green; stroke:black; stroke-width:0.1cm' transform='translate(-70,150)'/>
            </g>
          </svg>
          <div style='float:left; width:50%; padding-left:0.5em;'>
            <pre class='brush:xml'>
            &lt;style type="text/css"&gt;
              circle:hover {fill-opacity:0.9;}
            &lt;/style&gt;
            &lt;g style="fill-opacity:0.7;"&gt;
              &lt;circle cx="6.5cm" cy="2cm" r="100"
                style="fill:red; stroke:black;
                       stroke-width:0.1cm"
               transform="translate(0,50)"/&gt;
              &lt;circle cx="6.5cm" cy="2cm" r="100"
                style="fill:blue; stroke:black;
                       stroke-width:0.1cm"
               transform="translate(70,150)"/&gt;
              &lt;circle cx="6.5cm" cy="2cm" r="100"
                style="fill:green; stroke:black;
                       stroke-width:0.1cm"
               transform="translate(-70,150)"/&gt;
            &lt;/g&gt;
            </pre>
          <div>
        </section>
      </div>

      <div class="slide">
        <header> <h1>&lt;canvas&gt; working with bitmap data</h1> <hr> </header>
        <section>
          <svg width='40%' height='100%' style='float:left'>
            <image x='0' y='25' width='300px' height='150px' xlink:href='html5/google_color.png'/>
            <line x1='150' y1='175' x2='150' y2='325'/>
            <polygon points='150,325 145,315 155,315'/>
            <image x='0' y='325' width='300px' height='150px' xlink:href='html5/google_gray.png'/>
          </svg>

          <div style='float:left; width:55%; padding-left:0.5em;'>
            <pre class='brush:js'>
            var pix = ctx.getImageData(0, 0,
              canvas.width, canvas.height);
            for (var y = 0; y &lt; pix.height; y++) {
              for (var x = 0; x &lt; pix.width; x++) {
                var i = (y * 4) * pix.width + x * 4;
                var avg = (pix.data[i] + 
                           pix.data[i + 1] + 
                           pix.data[i + 2]
                          ) / 3;
                pix.data[i] = avg; 
                pix.data[i + 1] = avg; 
                pix.data[i + 2] = avg;
              }
            }

            ctx.putImageData(pix, 0, 0, 0, 0,
              pix.width, pix.height);
            return canvas.toDataURL();
            </pre>
          </div>
        </section>
      </div>

      <div class="slide">
        <header>Canvas – Very dynamic 2D apps (like games) <hr> </header>
        <div class='demo' style='top:6em;text-align:center;'>
          <iframe width='90%' height='100%' scrolling='no' _src='http://www.monocubed.com/doodles/processingjs/gmail/26/'></iframe>
          <!--iframe width='90%' height='100%' scrolling='no' _src='http://cgdc8.fizzlebot.com/SandTrap.g/sand-trap.htm'></iframe-->
        </div>
      </div>

      <div class="slide" oninit='initPics(this, _positions1, 45)' onload='animatePics(this, _positions1)' onunload='initPics(this, _positions1, 45)'>
        <script>
        var _positions1 = [
          { x:150, y:200, r:-20 },
          { x:-20, y: 20, r:-20 },
          { x:  0, y:350, r: 30 },
          { x:550, y:350, r:-30 },
          { x:450, y:  0, r: 25 },
          { x:400, y:300, r:-15 },
        ];
        </script>
        <header> <h1>3D CSS and WebGL &mdash; Dynamic 3D</h1> <hr> </header>
        <section style='height:23em'>
          <img class='pic' style='width:400px; height:200px;' src='html5/collectibles2.png'>
          <img class='pic' style='width:400px; height:200px;' src='html5/css3.png'>
          <img class='pic' style='width:300px; height:200px;' src='html5/cube.png'>
          <img class='pic' style='width:300px; height:200px;' src='html5/pool.png'>
          <img class='pic' style='width:400px; height:250px;' src='html5/photos.png'>
          <img class='pic' style='width:300px; height:200px;' src='html5/webgl.png'>
        </section>
      </div>

      <div class="slide">
        <header> <h1>3D CSS creates engaging effects</h1> <hr> </header>
        <section>
          <iframe style='border:0; width:40%; height: 350px; float:left;'
            scrolling='no'
            _src='http://webkit.org/blog-files/3d-transforms/image-flip.html'>
          </iframe>

          <div style='float:left; width:55%; padding-left:0.5em;'>
            <pre class='brush:css'>
            #flip-card {
              width: 100%;
              height: 100%;
              -webkit-transform-style: preserve-3d;
              -webkit-transition: -webkit-transform 1s;
            }

            #flip-container:hover #flip-card {
              -webkit-transform: rotateY(180deg);
            }
            </pre>
          </div>
        </section>
      </div>

      <div class="slide">
        <header> <h1>WebGL creates for immersive 3D experiences</h1> <hr> </header>
        <section>
          <img src='html5/aquarium.png' style='float:left; margin:1em;'>
          <div style='float:left; padding-top:1em;'>
            All the power of OpenGL ES 2.0
            <div style='padding-left:1em;'>
              <ul>
                <li class='dot'>Perspective</li>
                <li class='dot'>Textures</li>
                <li class='dot'>Shaders</li>
              </ul>
            </div>
          </div>
        </section>
      </div>

      <div class="slide">
        <header> <h1>3D graphics pipeline + serving</h1> <hr> </header>
        <section>
          <svg width='100%' height='100%' style='float:left'>
            <image x='250' y='100' width='500px' height='250px' xlink:href='html5/aquarium.png'/>

            <text x='100' y='50' text-anchor='middle'>UI (web dev)</text>
            <g transform='translate(100,60) rotate(30)'>
              <line x1='0' y1='0' x2='250' y2='0'/>
              <polygon points='250,0 240,5 240,-5'/>
            </g>

            <image x='0' y='325' width='200px' height='100px' xlink:href='html5/asset_shark.png'/>
            <image x='125' y='375' width='96px' height='96px' xlink:href='html5/asset_bg.png'/>
            <text x='125' y='500' text-anchor='middle'>Assets (artists)</text>
            <g transform='translate(210,490) rotate(-45)'>
              <line x1='0' y1='0' x2='275' y2='0'/>
              <polygon points='275,0 265,5 265,-5'/>
            </g>

            <text x='600' y='40' text-anchor='middle'>Server/Hosting (backend eng)</text>
            <g transform='translate(600,50) rotate(160)'>
              <line x1='0' y1='0' x2='200' y2='0'/>
              <polygon points='200,0 190,5 190,-5'/>
            </g>

            <text x='600' y='480' text-anchor='middle'>Shaders and Engine</text>
            <text x='600' y='510' text-anchor='middle'>(graphics engineers)</text>
            <g transform='translate(600,450) rotate(240)'>
              <line x1='0' y1='0' x2='200' y2='0'/>
              <polygon points='200,0 190,5 190,-5'/>
            </g>
          </svg>
        </section>
      </div>

      <div class="slide segue green">
        <section class="intro">
          <h2>Case Study: Porting a game to the web</h2>
          <hr>
        </section>
      </div>

      <div class="slide">
        <header> <h1>The Goal</h1> <hr> </header>
        <section>
          <ul>
            <li>Port a full game in all its complexity</li>
            <li>Explore the bounds of what’s possible in the browser</li>
            <li>Find the browser’s soft spots
              <ul>
                <li>Then fix them!</li>
              </ul>
            </li>
          </ul>
        </section>
      </div>

      <div class="slide">
        <div class='demo'>
          <iframe width='100%' height='100%' scrolling='no' _src='http://the.atl.corp.google.com:8080/GwtQuake.html'></iframe>
        </div>
      </div>

      <div class="slide">
        <header> <h1>Why Quake II</h1> <hr> </header>
        <section>
          <ul>
            <li>It might be a bit old (1997), but it was cutting edge at the time</li>
            <li>A Java port (Jake2) already existed</li>
            <li>We have a Java -&gt; Javascript compiler (GWT)</li>
            <li>Quake III would almost certainly perform just as well</li>
          </ul>
        </section>
      </div>

      <div class="slide">
        <header> <h1>The Technologies</h1> <hr> </header>
        <section>
          <table class='tech'>
            <tbody class='buildup'>
              <tr><td>Graphics</td><td>&lt;canvas&gt;, WebGL</td></tr>
              <tr><td>Media</td><td>&lt;audio&gt;, &lt;video&gt;</td></tr>
              <tr><td>Network</td><td>WebSocket</td></tr>
              <tr><td>Filesystem</td><td>LocalStorage</td></tr>
              <tr><td>Binary Data</td><td>TypedArray</td></tr>
            </tbody>
          </table>
        </section>
      </div>

      <div class="slide">
        <header> <h1>Porting Process</h1> <hr> </header>
        <div class='buildup'>
          <section>
            <ul>
              <li>Get something working
                <ul>
                  <li>Get the code to cross-compile</li>
                  <li>Load maps and models asynchronously</li>
                  <li>Port network code to WebSocket</li>
                  <li>Build a simple wireframe renderer</li>
                </ul>
              </li>
            </ul>
          </section>
          <img src='html5/quake_wireframe.png'
            style='position:absolute; width:512px; height:384px; right:0px; bottom:0px; -webkit-transform:rotate(-10deg)'>
        </div>
      </div>

      <div class="slide">
        <header> <h1>Porting Process</h1> <hr> </header>
        <div class='buildup'>
          <section>
            <ul>
              <li>Get something working well!
                <ul>
                  <li>Bridge OpenGL 1.1 -&gt; WebGL</li>
                  <li>Get multi-player working first</li>
                  <li>Port game logic to get single-player working</li>
                </ul>
              </li>
            </ul>
          </section>
          <img src='html5/quake_rendered.png'
            style='position:absolute; width:512px; height:384px; right:0px; bottom:0px; -webkit-transform:rotate(-10deg)'>
        </div>
      </div>

      <div class="slide">
        <header> <h1>Performance</h1> <hr> </header>
        <div class='buildup'>
          <img src='html5/quake_fps.png'
            style='position:absolute; right:128px; top:48px; -webkit-transform:rotate(10deg) scale(5)'>
          <section>
            <ul>
              <li>~30 f/s on MacBook Pro</li>
              <li>Could be significantly improved
                <ul>
                  <li>Better use of shaders</li>
                  <li>More careful optimization</li>
                </ul>
              </li>
              <li>Relatively poor load times
                <ul>
                  <li>Large binary object files pose difficulties</li>
                </ul>
              </li>
            </ul>
          </section>
        </div>
      </div>

      <div class="slide">
        <header> <h1>Why the web (redux)</h1> <hr> </header>
        <section>
          <ul>
            <li>No install
              <ul>
                <li>No friction</li>
                <li>Share links</li>
              </ul>
            </li>
            <li>Seamless update
              <ul>
                <li>No more client/server mismatches</li>
              </ul>
            </li>
            <li>Cross-platform device support
              <ul>
                <li>Why can't I play on my Mac?</li>
              </ul>
            </li>
          </ul>
        </section>
      </div>

      <div class="slide">
        <header> <h1>The high points</h1> <hr> </header>
        <section>
          <ul>
            <li>WebGL was exactly what we wanted</li>
            <li>Vertex and fragment shaders are awesome!
              <ul>
                <li>Takes most of the burden off the Javascript VM</li>
              </ul>
            </li>
            <li>Performance much better than expected</li>
            <li>WebSockets work beautifully
              <ul>
                <li>Atlanta - San Francisco deathmatch works well</li>
                <li>Atlanta - Sydney is passable</li>
              </ul>
            </li>
            <li>Async resource loading not as difficult as expected
              <ul>
                <li>Let the browser deal with it!</li>
              </ul>
            </li>
          </ul>
        </section>
        <img src='html5/quake_loading.png'
          style='position:absolute; width:384px; height:256px; right:8px; bottom:8px;'>
      </div>

      <div class="slide">
        <header> <h1>The low points</h1> <hr> </header>
        <section>
          <ul>
            <li>No fullscreen mode</li>
            <li>Main game loop on a timer (not sync'd to retrace)</li>
            <li>Parsing binary data excruciatingly slow</li>
            <li>Insufficient control over input devices</li>
            <li>&lt;audio&gt; tag insufficient for low-latency audio</li>
          </ul>
        </section>
      </div>

      <div class="slide">
        <header> <h1>The future</h1> <hr> </header>
        <section>
          <ul>
            <li>Mozilla Animation API</li>
            <li>Mozilla Audio Data API </li>
            <li>Working groups discussing:
              <ul>
                <li>Full-screen API</li>
                <li>Wedding TypedArray to other APIs</li>
              </ul>
            </li>
          </ul>
        </section>
      </div>

      <div class="slide segue red">
        <section class="intro">
          <h2>Questions?</h2>
          <hr>
        </section>
      </div>

    </div> <!-- slides -->
  </div> <!-- presentation -->

  <script src='/slides/client/slides.coffee'></script>
</body>
</html>
